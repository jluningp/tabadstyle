structure                                                            
 ==                                                           
  =                                                          
   struct                                                         
    val                                                        
     (op                                                       
      =)                                                      
       =                                                     
        (op                                                    
         @)                                                   
          fun                                                  
           fun_                                                 
            -                                                
             `                                               
              =                                              
               List.exists                                             
                fun_                                            
                 `                                           
                  fun                                          
                   $                                         
                    *                                        
                     !                                       
                      =                                      
                       List.tabulate($,!)                                     
                        fun                                    
                         ?                                   
                          +                                  
                           List                                 
                            =                                
                             List.take(?,List)                               
                             fun List                              
                            /   drop                             
                           =     List.drop(List,drop)                            
                          fun       !x                           
                         =         List.length                          
                        x           end                         
                       structure             ?                        
                      =               struct                       
                     fun                 $                      
                    ::                   `                     
                   =                     `                    
                  =                       $;                   
                 open                         ==;                  
                fun                           ???                 
               `                             ``                
              =                               `               
             ::                                 ``              
            orelse                                   (fn             
           ``                                     =>            
          ``                                       ::           
         `)                                         -          
        ((!                                           ``)         
       *                                             (fn        
      `                                               =>       
     (``                                                 /      
    `)                                                   @     
   (``                                                     +    
  `)))                                                       end   
 val                                                         is_rotation  
=                                                           ?.??? 
